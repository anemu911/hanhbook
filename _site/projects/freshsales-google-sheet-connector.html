<!doctype html>

<html class="no-js" lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<!-- Page Info
	<link rel="shortcut icon" href="/images/photo-japan.jpg">
  <title>Freshsales Google Sheet Connector BTS – Han(h)book</title>
	<meta name="description" content="">
	-->

	<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Freshsales Google Sheet Connector BTS</title>
<meta name="generator" content="Jekyll v3.9.1" />
<meta property="og:title" content="Freshsales Google Sheet Connector BTS" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/projects/freshsales-google-sheet-connector" />
<meta property="og:url" content="http://localhost:4000/projects/freshsales-google-sheet-connector" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-05-10T00:00:00+08:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://localhost:4000/projects/freshsales-google-sheet-connector","headline":"Freshsales Google Sheet Connector BTS","dateModified":"2020-05-10T00:00:00+08:00","datePublished":"2020-05-10T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/projects/freshsales-google-sheet-connector"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

	<meta name="robots" content="index,follow">

	<!-- Facebook OpenGraph -->
	<meta property="og:title" content="Freshsales Google Sheet Connector BTS – Han(h)book" />
	<meta property="og:description" content="" />
	<meta property="og:image" content="http://localhost:4000/images/projects/freshsales-gsheet-connector.png" />
	
	
	<!-- Font Embed Code -->
	<link href="https://fonts.googleapis.com/css2?family=Oxygen:400,500" rel="stylesheet">
	

	<!-- Styles -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="/css/style.css">

	<!-- Icons -->
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/solid.js" integrity="sha384-GXi56ipjsBwAe6v5X4xSrVNXGOmpdJYZEEh/0/GqJ3JTHsfDsF8v0YQvZCJYAiGu" crossorigin="anonymous"></script>
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/brands.js" integrity="sha384-0inRy4HkP0hJ038ZyfQ4vLl+F4POKbqnaUB6ewmU4dWP0ki8Q27A0VFiVRIpscvL" crossorigin="anonymous"></script>
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/fontawesome.js" integrity="sha384-NY6PHjYLP2f+gL3uaVfqUZImmw71ArL9+Roi9o+I4+RBqArA2CfW1sJ1wkABFfPe" crossorigin="anonymous"></script>

	
	<!-- Custom Styles -->
	<style></style>
	

	
	<!-- Analytics Code -->
	
	

	
	<!-- Extra Header JS Code -->
	
	

	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-MQNPDXJ');</script>
	<!-- End Google Tag Manager -->

</head>


<body class="loading ajax-loading" data-site-url="http://localhost:4000" data-page-url="/projects/freshsales-google-sheet-connector">
	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MQNPDXJ"
	height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->

	<header class="header">

	<div class="header__content">

		
		<a href="/" class="header__title">
			Han(h)book
		</a>
		

		<h1 class="header__tagline">Learn to live • Live to learn</h1>

		<div class="menu">
			<div class="menu__toggle js-menu-toggle">
				<div class="menu__toggle__icon"><span></span></div>
			</div>

			<div class="menu__wrap">

				<ul class="menu__list">
					<li><p style="font-size: 14px	">Han(h)book is where I write, reflect and document my learnings like</p><br/></li>
					
					<li class="menu__list__item">
						<a href="/simple-living" class="menu__list__item__link">Simple Living</a>
					</li>
					
					<li class="menu__list__item">
						<a href="/projects/" class="menu__list__item__link">Random Projects</a>
					</li>
					
					<li class="menu__list__item">
						<a href="/product-management" class="menu__list__item__link">Product Management</a>
					</li>
					
					<li class="menu__list__item">
						<a href="/books" class="menu__list__item__link">Books</a>
					</li>
					
					<li class="menu__list__item">
						<a href="/corner" class="menu__list__item__link">Corner</a>
					</li>
					
					<li class="menu__list__item">
						<a href="/about" class="menu__list__item__link">About</a>
					</li>
					
					<li class="menu__list__item">
						<a href="/contact" class="menu__list__item__link">Contact</a>
					</li>
					
				</ul>
			</div>
		</div>

		<!-- This block of code shows latest articles which are redundant
		<div class="projects-menu">
			<ul class="menu__list">
				
				<li class="menu__list__item">
					<a href="/projects/self-study-korean-syllabus" class="menu__list__item__link">My self-study Korean syllabus</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/yoga-classes-interesting-facts-2" class="menu__list__item__link">Yoga classes - Interesting facts 2</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/flashclock" class="menu__list__item__link">FlashClock Introduction</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/flashclock-privacy-policy" class="menu__list__item__link">FlashClock Privacy Policy</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/lesson-of-discipline" class="menu__list__item__link">Lesson of discipline</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/insight-timer-meditation-app-interesting-facts" class="menu__list__item__link">Insight Timer - Meditation app: Interesting facts</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/yoga-classes-interesting-facts" class="menu__list__item__link">Yoga classes: Interesting facts</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/whatsapp-with-freshchat" class="menu__list__item__link">Whatsapp app in Freshchat: How to use</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/whatsapp-with-freshchat-privacy-policy" class="menu__list__item__link">Whatsapp app in Freshchat: Privacy Policy</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/cookclean-life" class="menu__list__item__link">Recipe matching 2: Cookclean.life</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/freshsales-google-sheet-connector-how-to-use" class="menu__list__item__link">Freshsales Google Sheet Connector How to use</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/freshsales-google-sheet-connector-privacy-policy" class="menu__list__item__link">Freshsales Google Sheet Connector Privacy Policy</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/freshsales-google-sheet-connector-intro" class="menu__list__item__link">Freshsales Google Sheet Connector Intro</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/freshsales-google-sheet-connector" class="menu__list__item__link">Freshsales Google Sheet Connector BTS</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/matching-recipes" class="menu__list__item__link">Recipe Matching</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/seat-hogging-in-public-space" class="menu__list__item__link">Seat Hogging</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/event-listing-website" class="menu__list__item__link">Event Listing</a>
				</li>
				
				<li class="menu__list__item">
					<a href="/projects/tracking-extension" class="menu__list__item__link">Tracking Extension</a>
				</li>
				
			</ul>
		</div>
		-->

		<div class="header__lower">

			<ul class="socials">
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<li class="socials__item">
		<a href="https://github.com/anemu911" target="_blank" class="socials__item__link" title="Github">
			<i class="fab fa-github" aria-hidden="true"></i>
		</a>
	</li>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<li class="socials__item">
		<a href="https://www.linkedin.com/in/hanh-b-59772376/" target="_blank" class="socials__item__link" title="Linkedin">
			<i class="fab fa-linkedin" aria-hidden="true"></i>
		</a>
	</li>
	
	
</ul>

			<div class="footer__copyright">
				<span>© 2022 Han(h)book</span>

			</div>

		</div>

	</div>

</header>



	<div class="loader"><svg width="120" height="30" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg"><circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="60" cy="15" r="9" fill-opacity="0.3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="0.5" to="0.5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle></svg></div>

	<div class="page-loader"></div>


	<div class="page">

		<div class="page__content" data-page-title="Freshsales Google Sheet Connector BTS – Han(h)book">

			<section class="intro">

	<div class="wrap">
		<small>2020-05-10 00:00:00 +0800</small>
		<br><br>
		<h1>Freshsales Google Sheet Connector BTS</h1>
		<p></p>

	</div>

</section>

<section class="single">

	<div class="wrap">

		<h3 id="problem">Problem</h3>
<p>My company switches from Salesforce to Freshsales. For reporting purposes, users need to download reports in CSV from Freshsales and upload into Google Sheet (GSheet) to further sync with other data. Salesforces has an existing GSheet connector but Freshsales doesn’t.</p>

<h3 id="approach">Approach</h3>
<p>This is a perfect use case to be tackled using Google Apps Script. The more I get to know about GAS, the more I realise how powerful Google is. It’s so hard not to use Google because of the eco-system it creates for users and developers. Anyway, I digress. As I don’t have any experience in creating a full add-ons before so I really took step by step, hard coded as much as I could before switching on one variable by one variable.</p>

<h3 id="mvp">MVP</h3>
<p><em>Scope:</em>
The MVP in my mind is simple. User is able to “log in” using their Freshsales account and retrieve data based on specified filters. The report would then be retrieved and inserted into the current GSheet.</p>

<p><em>Steps taken:</em>
My first use case is simple: Get deals based on 2 filters - deal pipeline and created date.</p>

<ol>
  <li>Go into Freshsales and figure what APIs are required to generate data. Test them using Postman. Zoom down into what APIs and what required data that I can access and manipulate.</li>
  <li>Go to GAS and call the same APIs in Google Apps Script using <a href="https://developers.google.com/apps-script/reference/url-fetch/url-fetch-app">URLFetchApp</a>. I did a lot of trial and error to ensure I can retrieve and access data as I want. Any other variables required to access API at this point were hard coded.</li>
  <li>In GAS, from the data I got, I wrote a function to transform it to CSV format and paste in Google Sheet using <a href="https://developers.google.com/apps-script/reference/spreadsheet/range#setvaluesvalues">Range function</a>. At this point, I just used “hard-coded” columns as selected columns were not in my MVP.</li>
</ol>

<p>With this backbone, I could add more stuff to create a full product.</p>

<ol>
  <li>
    <p>Once the first use case was roughly done, I started working on the <a href="https://developers.google.com/apps-script/guides/html">frontend</a>. This was when I switched on one variable by one that I hard coded before. I started with url, token and date. Then I added pipeline, columns in CSV and stage. I went back and forth to modify the backend to receive and send data when necessary. This part really took a lot of time. Not just that, I struggled with the design and in the end used Bootstrap to get rid of the design headache. I also experimented with showing errors at this point.</p>
  </li>
  <li>
    <p>Now I had a workable add-on, I turned my attention to the CSV and I realised that there were a lot of values in <code class="language-plaintext highlighter-rouge">id</code>, not the actual <code class="language-plaintext highlighter-rouge">value</code> for some columns. I modified the backend so that when it transforms data, it will try to map the <code class="language-plaintext highlighter-rouge">value</code> with the <code class="language-plaintext highlighter-rouge">id</code> instead.</p>
  </li>
</ol>

<h3 id="result">Result</h3>
<p>Below is the MVP looks so far</p>

<p><strong>User has to put in company name and API token</strong></p>

<p><img src="/images/projects/fs-login.png" alt="Freshsales GSheet Login" /></p>

<p><strong>User can select which columns to show in CSV instead of retrieving everything:</strong></p>

<p><img src="/images/projects/fs-columns.png" alt="Freshsales GSheet Columns" /></p>

<p><strong>Basic filters: date, pipeline, stage:</strong>
<img src="/images/projects/fs-filters.png" alt="Freshsales GSheet Filters" /></p>

<h3 id="learnings">Learnings</h3>
<p>Reading documents is key. My comprehension was not fast so I had to read, try then realise it didn’t work. Sometimes, it was because of typo.
Spending too much on design is never a good idea in creating MVP.
I learnt how to send data to frontend and vice versa. It turns out to be very tedious and I really appreciate all the interactions I saw on the website.</p>

<p><strong>Personal Notes:</strong> The first time I started writing my first line in Javascript was with Google Apps Script. Last time when it came to coding, I took time to understand things and I was usually annoyed at myself and tired because the code most of the time didn’t work (it still doesn’t because of some silly mistakes). I never know that I have come this far: able to create a Google Sheet add-on. The code is not complex but knowing every single line I wrote was a reflection / result of such a painful yet exciting self-learn journey I have undertaken. I want to thank my patience and my belief to keep learning though not knowing the future.</p>

<h3 id="updates">Updates</h3>
<p>Finally my add-on got approved. It was so painful, partly I had to learn how to provide necessary information to the reviewer (I didn’t know that they manually reviewed every add-on). Since then, I did multiple updates to make it look nicer and add few more functions. It was a great project that I did lose sleep and was stressed over it sometimes but it was so worth it.</p>


	</div>

</section>


		</div>

	</div>


	<footer class="footer">

	<ul class="socials">
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<li class="socials__item">
		<a href="https://github.com/anemu911" target="_blank" class="socials__item__link" title="Github">
			<i class="fab fa-github" aria-hidden="true"></i>
		</a>
	</li>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<li class="socials__item">
		<a href="https://www.linkedin.com/in/hanh-b-59772376/" target="_blank" class="socials__item__link" title="Linkedin">
			<i class="fab fa-linkedin" aria-hidden="true"></i>
		</a>
	</li>
	
	
</ul>

	<div class="footer__copyright">
		<span>© 2022 Han(h)book</span>
	</div>

</footer>


	<!-- Javascript Assets -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="/js/index-min.js"></script>

	
	<!-- Extra Footer JS Code -->
	
	


</body>

</html>
